-- Test matrix read and write slicing
--
-- The current implementation supports for
-- the row and column slicer:
--
--            +-----+----------+-----+----------+
--            | INT | LIST INT | SEG | LIST SEG |
-- +----------+-----+----------+-----+----------+
-- | INT      | r/w | r/w      | r/w | r/w      |
-- | LIST INT | r/w | r/w      | r/w | r/w      |
-- | SEG      | r/w | r/w      | r/w | r/w      |
-- | LIST SEG | r/w | r/w      | r/w | r/w      |
-- +----------+-----+----------+-----+----------+

--------------------------
-- Read and slice tests --
--------------------------

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])

-- INT, INT
m
m(1,1)

-- INT, LIST INT and LIST INT, INT
m
m(1, [1,3])
m([1,3], 2)

-- INT, SEG and SEG, INT
m
m(1, 1..2)
m(2..3, 2)

-- INT, LIST SEG and LIST SEG, INT
m
m(2, [1..2,2..3])
m(1, [3..1by-1,1..3])
m(1, [1..3,2..3])

m([1..2,2..3], 2)
m([3..1by-1,1..3], 1)
m([1..3,2..4], 3)

-- SEG, SEG
m
m(1..3, 2..3)

-- LIST INT, LIST INT
m
m([1,4], [1,3])

-- LIST INT, SEG and SEG, LIST INT
m
m([1,1,1], 1..2)
m(2..4, [3,2,1])

-- LIST INT, LIST SEG and LIST SEG, LIST INT
m
m([1,2,1], [1..2,2..3])
m([2..4,1..2], [3,2,1])

-- LIST SEG, SEG and SEG, LIST SEG
m
m([1..2,1..2], 2..3)
m(2..1by-1, [1..3,2])

-- LIST SEG, LIST SEG
m
m([1..2,1..2], [1..3,2..3])
m([1..2,1..2], [1..3,2])


-- A bug(?) in check_segment
m([1..2,2..1], 1)
m([1..3,3..1], 1)

m(1, [1..2,2..1])
m(1, [1..3,3..1])


----------------------------
-- Write and assign tests --
----------------------------


-- INT, INT
m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
m(2,3) := -1
m

-- INT, LIST INT and LIST INT, INT
m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2]])
m(1, [1,3]) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1],[-2]])
m([1,3], 2) := n
m

-- INT, SEG and SEG, INT
m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2]])
m(1, 1..2) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1],[-2]])
m(2..3, 2) := n
m

-- INT, LIST SEG and LIST SEG, INT
m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2,-3,-4]])
m(2, [1..2,2..3]) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2,-3,-4,-5,-6]])
m(1, [1..3,3..1by-1]) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2,-3,-4,-5]])
m(1, [1..3,2..3]) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1],[-2],[-3],[-4]])
m([1..2,2..3], 2) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1],[-2],[-3],[-4],[-5],[-6]])
m([1..3,3..1by-1], 1) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1],[-2],[-3],[-4],[-5],[-6]])
m([1..3,2..4], 3) := n
m

-- SEG, SEG
m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2],[-3,-4],[-5,-6]])
m(1..3, 2..3) := n
m

-- LIST INT, LIST INT
m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2],[-3,-4]])
m([1,4], [1,3]) := n
m

-- LIST INT, SEG and SEG, LIST INT
m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2],[-3,-4],[-5,-6]])
m([1,1,1], 1..2) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2,-3],[-4,-5,-6],[-7,-8,-9]])
m(2..4, [3,2,1]) := n
m

-- LIST INT, LIST SEG and LIST SEG, LIST INT
m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2,-3,-4],[-5,-6,-7,-8],[-9,-10,-11,-12]])
m([1,2,1], [1..2,2..3]) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2,-3],[-4,-5,-6],[-7,-8,-9],[-10,-11,-12],[-13,-14,-15]])
m([2..4,1..2], [3,2,1]) := n
m

-- LIST SEG, SEG and SEG, LIST SEG
m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2],[-3,-4],[-5,-6],[-7,-8]])
m([1..2,1..2], 2..3) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2,-3,-4],[-5,-6,-7,-8]])
m(2..1by-1, [1..3,2]) := n
m

-- LIST SEG, LIST SEG
m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2,-3,-4,-5],[-6,-7,-8,-9,-10],[-11,-12,-13,-14,-15],[-16,-17,-18,-19,-20]])
m([1..2,1..2], [1..3,2..3]) := n
m

m := matrix([[1,2,3],[4,5,6],[7,8,9],[10,11,12]])
n := matrix([[-1,-2,-3,-4],[-5,-6,-7,-8],[-9,-10,-11,-12],[-13,-14,-15,-16]])
m([1..2,1..2], [1..3,2]) := n
m
